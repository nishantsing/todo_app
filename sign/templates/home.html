<!DOCTYPE html>
<html>
<head>
	<title>Home</title>
	<meta charset="UTF-8">

	<script src="https://www.gstatic.com/firebasejs/7.16.0/firebase-app.js"></script>
	<script src="https://www.gstatic.com/firebasejs/7.16.0/firebase-analytics.js"></script>
	<script src="https://www.gstatic.com/firebasejs/7.16.0/firebase-auth.js"></script>

	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
	<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>

	<script src="{{ url_for('static', filename='config.js') }}"></script>
	<script>
		firebase.initializeApp(config);
		firebase.analytics();
	</script>      
	
</head>
<body>
	<h1>Home</h1><hr>
	<p id='para'></p>
	<button type="button" id="signout" onclick="signout()" class="btn">Sign Out</button>
	<button type="button" id="removea" class="btn">Remove Account</button>
</body>
	<script>
		var user = firebase.auth().currentUser;
		firebase.auth().onAuthStateChanged(function(user) {
			if (user) {
				document.getElementById('para').innerHTML = user.displayName+"<br>"+user.email+"<br>Verified:"+user.emailVerified+"<br><img src='"+user.photoURL+"'>";
			} else {
				window.alert('User not signed in Now');
				window.location.replace('/');
			}
		});
	</script>
	<script>
		document.getElementById('signout').addEventListener('click', function(e){
			if (confirm('You sure about Sign out?')) {
				firebase.auth().signOut().then(function() {
					// signed out
				}).catch(function(error) {
					window.alert("Sign out Failed")
				});
			} else {
				// Do nothing!			
			}			
		});

		document.getElementById('removea').addEventListener('click', function(e){
			if (confirm('You sure about Removing account?')) {
				var user = firebase.auth().currentUser;
				// var credential = firebase.auth.EmailAuthProvider.credential(
				// 	user.email,
				// 	null
				// );

				// user.reauthenticateWithCredential(credential).then(function() {
					user.delete().then(function() {
						window.alert('deleted');
						// User deleted.
					}).catch(function(error) {
						window.alert('Please Signin again & Remove');	// An error happened.
						firebase.auth().signOut();
					});
				// }).catch(function(error) {
				// 	window.alert("User NOT re-authenticated");	// An error happened.
				// });
			}else{
				// Do nothing!
			}	
		});
	</script>
</html>